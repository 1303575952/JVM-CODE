# 第2章 并发基础

## CPU多级缓存

![CPU多级缓存](pic/4.png)

* 为什么需要CPU cache：CPU频率太快，快到主存跟不上，这样在CPU处理器时钟周期内，CPU常常需要等待贮存，浪费资源。所以cache的出现，是为了缓解CPU和内存之间速度的不匹配问题（结构：cpu->cache->memory）。
* CPU cache有什么意义：时间局部性和空间局部性。

## CPU多级缓存-缓存一致性（MESI）

* 用于保证多个CPU cache之间缓存共享数据的一致。（四种操作：local read、local write、remote read、remote write）

![MESI状态转换](pic/MESI状态转换.png)

触发事件

| 触发事件 |            描述            |
| :------: | :------------------------: |
| 本地读取 | 本地cache读取本地cache数据 |
| 本地写入 | 本地cache写入本地cache数据 |
| 远端读取 | 其他cache读取本地cache数据 |
| 远端写入 | 其他cache写入本地cache数据 |

上图的切换解释